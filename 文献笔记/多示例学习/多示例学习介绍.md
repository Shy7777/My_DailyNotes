多示例学习（Multiple Instance Learning, MIL）是一种弱监督学习范式，其核心思想是通过 **包（bag）** 和 **实例（instance）** 的层级结构处理数据。每个包由多个实例组成，且只有包被标注标签（如 “正” 或 “负”），而实例的标签未知。MIL 的目标是通过学习包级标签来推断实例的相关性，并对新包进行预测。

### 核心概念与基本假设

1. **数据结构**
    
    - **包**：数据的基本单元，包含多个实例（如医学图像中的多个切片、文本中的多个段落）。
    - **实例**：包内的具体数据点，其标签不可直接观测。
    - **标签规则**：
        
        - 若包为正，则至少存在一个正实例（标准假设）。
        - 若包为负，则所有实例均为负。
        
    
2. **典型场景**
    
    - **药物活性预测**：分子的不同构象作为实例，活性分子对应正包，但无法确定具体构象。
    - **图像分类**：一幅图像视为一个包，分割的区域为实例，图像级标签（如 “海滩”）隐含部分区域的语义。
    

### 发展历程与算法演进

1. **传统方法**
    
    - **Diverse Density（DD）**：通过最大化包内正实例的概率密度识别关键实例。
    - **Citation-KNN**：基于包间相似性和引用关系进行分类。
    - **MI-SVM**：将包映射为特征向量，利用支持向量机处理包级分类。
    
2. **深度学习方法**
    
    - **注意力机制**：如 ABMIL 和 GAMIL，动态分配实例权重，聚焦关键区域。但存在依赖虚假相关性（如染色条件）的问题，例如在全幻灯片图像（WSI）分类中可能忽略肿瘤形态。
    - **Transformer 与分层蒸馏**：2025 年 CVPR 入选的 HDMIL 框架，通过分层蒸馏快速识别无关实例，将推理时间降低 28.6%，并引入 Kolmogorov-Arnold 分类器提升性能。
    - **替代方案**：FocusMIL 采用最大池化和变分推理，避免注意力机制的局限性，在 Camelyon16 等基准测试中显著优于基线。
    

### 应用领域

1. **医疗影像分析**
    
    - **肿瘤检测**：WSI 分类中，通过 MIL 识别癌变区域，如乳腺癌淋巴转移检测。
    - **生物标志物预测**：基于 H&E 染色图像预测 PD-L1 表达，替代耗时的免疫组化检测。
    
2. **计算机视觉**
    
    - **图像检索**：通过包级语义（如 “猫”）定位图像中的相关区域。
    - **视频异常检测**：分析视频片段（包）中的异常行为。
    
3. **文本与推荐系统**
    
    - **文档分类**：处理语义模糊的文档集合，如新闻主题分类。
    - **推荐系统**：通过用户行为（包）推断兴趣偏好，优化推荐策略。
    

### 研究趋势与挑战

1. **与自监督学习结合**
    
    - 如 SMILES 架构，通过无监督方式学习多示例表示，在 5 个基准数据集上分类精度提升 4.9%。
    
2. **增量学习与知识蒸馏**
    
    - 面向增量分类的 MICIL 方法，通过存储类别原型和知识蒸馏，解决灾难性遗忘问题。
    
3. **可解释性与鲁棒性**
    
    - 改进注意力机制的可靠性，或采用基于规则的聚合方式（如最大池化），增强模型决策的可解释性。
    
4. **跨模态与多任务学习**
    
    - 结合文本、图像等多源数据，探索更复杂的弱监督场景。
    

### 总结

多示例学习通过灵活的包 - 实例结构，有效处理标注稀缺问题，在医疗、视觉等领域取得显著成果。近年来，深度学习与传统方法的融合推动了 MIL 的快速发展，未来需进一步解决可解释性、鲁棒性及跨领域泛化等挑战，同时探索与自监督、因果推断等技术的结合，以应对更复杂的现实任务。