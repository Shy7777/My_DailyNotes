投影头（projection head）在对比学习中是一个关键组件，它用于将编码器输出的特征进一步映射到一个新的表示空间，以增强对比学习的效果。它通常是一个小的神经网络（如 MLP），加在主编码器的输出之后，仅用于训练阶段。

---

## 投影头的核心作用

| 作用 | 解释 |
|------|------|
| **增强对比学习效果** | 投影头将特征映射到一个更适合计算对比损失的空间，使得学习更稳定、更有效 |
| **分离表征与对比目标** | 编码器学习的是通用表征，投影头学习的是对比任务的目标，两者功能分离 |
| **提升下游任务性能** | 实验表明：加入投影头后，主编码器学到的特征在迁移任务上表现更好 |

---

## 实证支持：SimCLR 和 MoCo v2 的发现

### SimCLR 的发现

- SimCLR 论文发现：直接用编码器输出计算对比损失效果不佳
- 加入一个两层 MLP 投影头后，准确率显著提升（从 61.9% → 69.3%）

### MoCo v2 的改进

- 在 MoCo v1 的基础上加入 MLP 投影头
- 准确率从 60.6% 提升到 71.1%
- 说明投影头对 MoCo 同样有效

---

## 投影头的结构示例（PyTorch 风格）

```python
# encoder 输出为 2048-D
# 投影头将其映射到 128-D 对比空间
projection_head = nn.Sequential(
    nn.Linear(2048, 2048),
    nn.ReLU(),
    nn.Linear(2048, 128)
)
```

- 第一层保持维度，加入非线性
- 第二层将特征压缩到对比空间（如 128-D）
- 输出通常会进行 L2 归一化

---

## 为什么训练时用，测试时不用？

- 投影头只用于训练阶段的对比损失计算
- 在下游任务（如分类、检测）中，使用的是主编码器的输出（不经过投影头）
- 这样可以保证编码器学习的是通用、可迁移的表征

---

## 总结

**投影头是对比学习中的增强模块，它将编码器输出映射到一个更适合对比损失的空间，从而提升训练效果和下游任务性能。它是训练时的“辅助模块”，而不是最终表征的一部分。**
